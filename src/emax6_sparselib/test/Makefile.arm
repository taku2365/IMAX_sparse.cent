PROJTOP	      = ../../
OPTION        = -mstrict-align  -DCYCLECNT -DARMZYNQ -DEMAX6 -DFPDDMA
SUFFIX = .c
EMAX6_SPARSE_TEST = $(wildcard test_*$(SUFFIX)) 
EMAX6_SPARSE_TEST_BIN = $(addprefix ../build_arm/,$(patsubst %.c,%+dma,$(EMAX6_SPARSE_TEST)))
CPP           = cpp -P
CC            = gcc
#CFLAGS        = -I. -O3 -g3 $(OPTION)
CFLAGS        = 
AS            = as
ASFLAGS       = 
LD            = gcc
LDFLAGS       =  -L ../ -L ../build_arm/
LIBS          = -lm -lc -lX11 -lXext -lsparse -lpthread
LIBFLAGS      = 
OBJS	      =	test_chipB_div-emax6.o test_chipA_div-emax6.o test_normal_mode.o 
INCLUDE = -I../Include
all:		$(EMAX6_SPARSE_TEST_BIN)
SHARED_LINK = 0
SHARED_PATH =
LINK_FORMAT = static

../build_arm/test_%+dma:     ../build_arm/test_%.o test_depend
		$(CC) $(INCLUDE)  $(LDFLAGS) -o $@ $< $(LIBFLAGS) $(LIBS) 

../build_arm/test_%.o:		test_%.c
		$(CC) $(INCLUDE)  $(CFLAGS) -c $< -o $@

pthread_test:     pthread_test.o test_depend
		$(CC) $(INCLUDE)  $(LDFLAGS) -o $@ $< $(LIBFLAGS) $(LIBS)
pthread_test.o:	pthread_test.c 
		$(CC) $(INCLUDE)  $(CFLAGS) -c $<





ifeq ($(LINK_FORMAT),static)
test_depend: ../conv-c2c/emax6.h ../conv-c2c/emax6lib.c ../Include/emax6_sparselib.h ../build_arm/libsparse.a
endif

ifeq ($(LINK_FORMAT),shared)
test_depend: ../conv-c2c/emax6.h ../conv-c2c/emax6lib.c ../Include/emax6_sparselib.h ../build_arm/libsparse.so

endif

# $(MAKE)はマクロも引き継がれる


clean:		
		rm -f *.o core *~ *-mark.c *-cppo.c *-emax6.c 